dropout0.5
(PyTorch) jiayi@jiayi-ubuntu24:~/Codes/GkNO$ /home/jiayi/anaconda3/envs/PyTorch/bin/python /home/jiayi/Codes/GkNO/eq2d/FFT_2D.py
data_in.shape: (2048, 421, 421)
data_out.shape (2048, 421, 421)
x_train.shape:  torch.Size([1000, 44521, 3])
y_train.shape:  torch.Size([1000, 44521, 1])
Start SVD with data shape:  (1000, 44521)
Start training  layer_type:  ['GalerkinConv_pca', 'GalerkinConv_pca', 'GalerkinConv_pca', 'GalerkinConv_pca']
Epoch :  0  Rel. Train L2 Loss :  0.18834493762254714  Rel. Test L2 Loss :  0.10118873238563537  Test L2 Loss :  0.0006835504621267318
Epoch :  10  Rel. Train L2 Loss :  0.023689205586910247  Rel. Test L2 Loss :  0.028323094099760054  Test L2 Loss :  0.00019079166115261613
Epoch :  20  Rel. Train L2 Loss :  0.018206364154815673  Rel. Test L2 Loss :  0.02442688152194023  Test L2 Loss :  0.0001645803707651794
Epoch :  30  Rel. Train L2 Loss :  0.01826096423715353  Rel. Test L2 Loss :  0.03267567232251167  Test L2 Loss :  0.00021577880950644614
Epoch :  40  Rel. Train L2 Loss :  0.01798805024474859  Rel. Test L2 Loss :  0.02099451206624508  Test L2 Loss :  0.00014341719885123893
Epoch :  50  Rel. Train L2 Loss :  0.01750388391315937  Rel. Test L2 Loss :  0.028239105343818665  Test L2 Loss :  0.0001931630272883922
Epoch :  60  Rel. Train L2 Loss :  0.016761694572865964  Rel. Test L2 Loss :  0.019397090747952463  Test L2 Loss :  0.00013160469476133585
Epoch :  70  Rel. Train L2 Loss :  0.018456393368542195  Rel. Test L2 Loss :  0.020359873548150064  Test L2 Loss :  0.00013815005106152968
Epoch :  80  Rel. Train L2 Loss :  0.017140503287315367  Rel. Test L2 Loss :  0.02416711375117302  Test L2 Loss :  0.00016349917510524392
Epoch :  90  Rel. Train L2 Loss :  0.01820605732500553  Rel. Test L2 Loss :  0.01981977917253971  Test L2 Loss :  0.0001338893352658488
Epoch :  100  Rel. Train L2 Loss :  0.015573303781449794  Rel. Test L2 Loss :  0.019368372559547424  Test L2 Loss :  0.0001310300509794615
Epoch :  110  Rel. Train L2 Loss :  0.017219842903316022  Rel. Test L2 Loss :  0.019733296930789946  Test L2 Loss :  0.00013342616381123662
Epoch :  120  Rel. Train L2 Loss :  0.015512746624648572  Rel. Test L2 Loss :  0.018869069442152976  Test L2 Loss :  0.00012821752665331587
Epoch :  130  Rel. Train L2 Loss :  0.015107656478881836  Rel. Test L2 Loss :  0.01860565409064293  Test L2 Loss :  0.00012648618692765012
Epoch :  140  Rel. Train L2 Loss :  0.015240439459681511  Rel. Test L2 Loss :  0.01978337951004505  Test L2 Loss :  0.00013456284999847413
Epoch :  150  Rel. Train L2 Loss :  0.014249142169952392  Rel. Test L2 Loss :  0.02019313395023346  Test L2 Loss :  0.00013668074214365333
Epoch :  160  Rel. Train L2 Loss :  0.013519416689872742  Rel. Test L2 Loss :  0.017892001308500768  Test L2 Loss :  0.00012024989002384245
Epoch :  170  Rel. Train L2 Loss :  0.0132482246235013  Rel. Test L2 Loss :  0.018233358412981033  Test L2 Loss :  0.00012229503772687167
Epoch :  180  Rel. Train L2 Loss :  0.013427421443164349  Rel. Test L2 Loss :  0.019035065434873103  Test L2 Loss :  0.00012901109759695827
Epoch :  190  Rel. Train L2 Loss :  0.013111975274980068  Rel. Test L2 Loss :  0.016198236495256424  Test L2 Loss :  0.00010972822841722519
Epoch :  200  Rel. Train L2 Loss :  0.011979163363575936  Rel. Test L2 Loss :  0.017795106470584868  Test L2 Loss :  0.00012056603212840855
Epoch :  210  Rel. Train L2 Loss :  0.012218044973909855  Rel. Test L2 Loss :  0.016794060580432413  Test L2 Loss :  0.00011393495457014069
Epoch :  220  Rel. Train L2 Loss :  0.01201289177685976  Rel. Test L2 Loss :  0.019833760634064675  Test L2 Loss :  0.0001320550250238739
Epoch :  230  Rel. Train L2 Loss :  0.01184657520055771  Rel. Test L2 Loss :  0.017754808515310288  Test L2 Loss :  0.00012010680948151275
Epoch :  240  Rel. Train L2 Loss :  0.011272925198078156  Rel. Test L2 Loss :  0.018821780160069464  Test L2 Loss :  0.00012881758506409823
Epoch :  250  Rel. Train L2 Loss :  0.010873710863292217  Rel. Test L2 Loss :  0.01591380074620247  Test L2 Loss :  0.00010757546173408628
Epoch :  260  Rel. Train L2 Loss :  0.01033345029503107  Rel. Test L2 Loss :  0.016530298553407194  Test L2 Loss :  0.00011249948933254927
Epoch :  270  Rel. Train L2 Loss :  0.010482752203941344  Rel. Test L2 Loss :  0.015223453417420388  Test L2 Loss :  0.00010304630908649415
Epoch :  280  Rel. Train L2 Loss :  0.010125953391194344  Rel. Test L2 Loss :  0.015409927889704704  Test L2 Loss :  0.00010398937040008605
Epoch :  290  Rel. Train L2 Loss :  0.010357578311115504  Rel. Test L2 Loss :  0.015622616522014141  Test L2 Loss :  0.0001059192037791945
Epoch :  300  Rel. Train L2 Loss :  0.009503361955285072  Rel. Test L2 Loss :  0.015084528736770153  Test L2 Loss :  0.00010200353513937443
Epoch :  310  Rel. Train L2 Loss :  0.009362164039164782  Rel. Test L2 Loss :  0.015508067421615123  Test L2 Loss :  0.0001051273159100674
Epoch :  320  Rel. Train L2 Loss :  0.009227636270225048  Rel. Test L2 Loss :  0.015410737954080106  Test L2 Loss :  0.00010410490271169693
Epoch :  330  Rel. Train L2 Loss :  0.008568512991070747  Rel. Test L2 Loss :  0.014685080647468566  Test L2 Loss :  9.940608317265286e-05
Epoch :  340  Rel. Train L2 Loss :  0.008718485545367003  Rel. Test L2 Loss :  0.014914866760373116  Test L2 Loss :  0.00010076587670482696
Epoch :  350  Rel. Train L2 Loss :  0.008385708767920733  Rel. Test L2 Loss :  0.014623961076140404  Test L2 Loss :  9.882683982141316e-05
Epoch :  360  Rel. Train L2 Loss :  0.007919679075479507  Rel. Test L2 Loss :  0.014610078483819962  Test L2 Loss :  9.86970731173642e-05
Epoch :  370  Rel. Train L2 Loss :  0.008059777498245239  Rel. Test L2 Loss :  0.015327370837330817  Test L2 Loss :  0.00010427467816043646
Epoch :  380  Rel. Train L2 Loss :  0.007675197288393974  Rel. Test L2 Loss :  0.014695562049746513  Test L2 Loss :  9.972253203159198e-05
Epoch :  390  Rel. Train L2 Loss :  0.007554598193615675  Rel. Test L2 Loss :  0.014482224732637406  Test L2 Loss :  9.776546357898042e-05
Epoch :  400  Rel. Train L2 Loss :  0.007200809292495251  Rel. Test L2 Loss :  0.014482804872095585  Test L2 Loss :  9.782352717593312e-05
Epoch :  410  Rel. Train L2 Loss :  0.007129086852073669  Rel. Test L2 Loss :  0.014227621369063853  Test L2 Loss :  9.634445363190026e-05
Epoch :  420  Rel. Train L2 Loss :  0.0068811055123806  Rel. Test L2 Loss :  0.014141289032995701  Test L2 Loss :  9.565098123857751e-05
Epoch :  430  Rel. Train L2 Loss :  0.006783401697874069  Rel. Test L2 Loss :  0.014190944880247115  Test L2 Loss :  9.593675989890472e-05
Epoch :  440  Rel. Train L2 Loss :  0.006645533435046673  Rel. Test L2 Loss :  0.01405057143419981  Test L2 Loss :  9.506054397206753e-05
Epoch :  450  Rel. Train L2 Loss :  0.0065506652519106865  Rel. Test L2 Loss :  0.014059044905006885  Test L2 Loss :  9.507164446404204e-05
Epoch :  460  Rel. Train L2 Loss :  0.00647234321013093  Rel. Test L2 Loss :  0.014036930724978447  Test L2 Loss :  9.493889490840956e-05
Epoch :  470  Rel. Train L2 Loss :  0.006339385446161032  Rel. Test L2 Loss :  0.013840308263897896  Test L2 Loss :  9.361093252664432e-05
Epoch :  480  Rel. Train L2 Loss :  0.006342536080628633  Rel. Test L2 Loss :  0.014018914476037026  Test L2 Loss :  9.464363363804296e-05
Epoch :  490  Rel. Train L2 Loss :  0.00627454300224781  Rel. Test L2 Loss :  0.014057329744100571  Test L2 Loss :  9.5036901475396e-05
Epoch :  499  Rel. Train L2 Loss :  0.00627702309563756  Rel. Test L2 Loss :  0.01399724680930376  Test L2 Loss :  9.47101874044165e-05

dropout0.7
data_in.shape: (2048, 421, 421)
data_out.shape (2048, 421, 421)
x_train.shape:  torch.Size([1000, 44521, 3])
y_train.shape:  torch.Size([1000, 44521, 1])
Start SVD with data shape:  (1000, 44521)
Start training  layer_type:  ['GalerkinConv_pca', 'GalerkinConv_pca', 'GalerkinConv_pca', 'GalerkinConv_pca']
Epoch :  0  Rel. Train L2 Loss :  0.20109857386350632  Rel. Test L2 Loss :  0.10823570370674133  Test L2 Loss :  0.0007360132341273129
Epoch :  10  Rel. Train L2 Loss :  0.02473580016195774  Rel. Test L2 Loss :  0.024795577079057694  Test L2 Loss :  0.00016786174615845083
Epoch :  20  Rel. Train L2 Loss :  0.02061076533794403  Rel. Test L2 Loss :  0.028166784346103667  Test L2 Loss :  0.00019186867924872786
Epoch :  30  Rel. Train L2 Loss :  0.018539721846580506  Rel. Test L2 Loss :  0.023326517418026924  Test L2 Loss :  0.00015839754632906988
Epoch :  40  Rel. Train L2 Loss :  0.019577734768390656  Rel. Test L2 Loss :  0.02769280567765236  Test L2 Loss :  0.00018993132340256125
Epoch :  50  Rel. Train L2 Loss :  0.02185030560195446  Rel. Test L2 Loss :  0.02184341140091419  Test L2 Loss :  0.0001473968935897574
Epoch :  60  Rel. Train L2 Loss :  0.02031301649659872  Rel. Test L2 Loss :  0.024956885427236557  Test L2 Loss :  0.00016804869344923644
Epoch :  70  Rel. Train L2 Loss :  0.020957507021725177  Rel. Test L2 Loss :  0.023582149893045426  Test L2 Loss :  0.00016010778490453957
Epoch :  80  Rel. Train L2 Loss :  0.017902565754950046  Rel. Test L2 Loss :  0.020310922861099243  Test L2 Loss :  0.0001376286376034841
Epoch :  90  Rel. Train L2 Loss :  0.019985325872898103  Rel. Test L2 Loss :  0.02056112006306648  Test L2 Loss :  0.00013929188397014515
Epoch :  100  Rel. Train L2 Loss :  0.017454124078154564  Rel. Test L2 Loss :  0.019943868480622767  Test L2 Loss :  0.0001347390213049948
Epoch :  110  Rel. Train L2 Loss :  0.017799418672919273  Rel. Test L2 Loss :  0.021477160006761552  Test L2 Loss :  0.0001441453822189942
Epoch :  120  Rel. Train L2 Loss :  0.016956500470638274  Rel. Test L2 Loss :  0.020125054493546485  Test L2 Loss :  0.00013550760369980707
Epoch :  130  Rel. Train L2 Loss :  0.016665217727422715  Rel. Test L2 Loss :  0.018539082519710065  Test L2 Loss :  0.00012526907637948171
Epoch :  140  Rel. Train L2 Loss :  0.015965353026986123  Rel. Test L2 Loss :  0.020035343542695046  Test L2 Loss :  0.0001353049449971877
Epoch :  150  Rel. Train L2 Loss :  0.01574738008528948  Rel. Test L2 Loss :  0.018934230618178845  Test L2 Loss :  0.0001281666406430304
Epoch :  160  Rel. Train L2 Loss :  0.015488725215196609  Rel. Test L2 Loss :  0.019355864375829698  Test L2 Loss :  0.0001310524996370077
Epoch :  170  Rel. Train L2 Loss :  0.015409800946712494  Rel. Test L2 Loss :  0.020592524856328964  Test L2 Loss :  0.00013787140924250706
Epoch :  180  Rel. Train L2 Loss :  0.015289943650364875  Rel. Test L2 Loss :  0.018920651450753213  Test L2 Loss :  0.00012785993254510686
Epoch :  190  Rel. Train L2 Loss :  0.014435219831764698  Rel. Test L2 Loss :  0.017891529016196728  Test L2 Loss :  0.0001209908101009205
Epoch :  200  Rel. Train L2 Loss :  0.014806954190135002  Rel. Test L2 Loss :  0.021560106202960016  Test L2 Loss :  0.00014491948997601866
Epoch :  210  Rel. Train L2 Loss :  0.01362169899791479  Rel. Test L2 Loss :  0.020840657502412797  Test L2 Loss :  0.00013977162423543633
Epoch :  220  Rel. Train L2 Loss :  0.013410025142133237  Rel. Test L2 Loss :  0.017976683415472507  Test L2 Loss :  0.0001211217264062725
Epoch :  230  Rel. Train L2 Loss :  0.014199362598359584  Rel. Test L2 Loss :  0.02004719778895378  Test L2 Loss :  0.0001362729538232088
Epoch :  240  Rel. Train L2 Loss :  0.012749815098941327  Rel. Test L2 Loss :  0.019131337143480778  Test L2 Loss :  0.00013020198472077027
Epoch :  250  Rel. Train L2 Loss :  0.013163019120693207  Rel. Test L2 Loss :  0.01642918836325407  Test L2 Loss :  0.0001109970168909058
Epoch :  260  Rel. Train L2 Loss :  0.012197644740343095  Rel. Test L2 Loss :  0.017301306128501892  Test L2 Loss :  0.0001169367422698997
Epoch :  270  Rel. Train L2 Loss :  0.01260078052431345  Rel. Test L2 Loss :  0.016758775599300862  Test L2 Loss :  0.0001135723470360972
Epoch :  280  Rel. Train L2 Loss :  0.011889128379523755  Rel. Test L2 Loss :  0.016291630789637565  Test L2 Loss :  0.00011001111444784328
Epoch :  290  Rel. Train L2 Loss :  0.01223021937906742  Rel. Test L2 Loss :  0.01629776306450367  Test L2 Loss :  0.00011062124453019351
Epoch :  300  Rel. Train L2 Loss :  0.01125989493727684  Rel. Test L2 Loss :  0.016639860942959786  Test L2 Loss :  0.00011305349471513182
Epoch :  310  Rel. Train L2 Loss :  0.011011623322963715  Rel. Test L2 Loss :  0.015926801301538944  Test L2 Loss :  0.00010778809897601604
Epoch :  320  Rel. Train L2 Loss :  0.010801297090947628  Rel. Test L2 Loss :  0.015815480574965478  Test L2 Loss :  0.00010723052633693442
Epoch :  330  Rel. Train L2 Loss :  0.010325503051280976  Rel. Test L2 Loss :  0.015691500827670096  Test L2 Loss :  0.00010610014054691419
Epoch :  340  Rel. Train L2 Loss :  0.010288780488073825  Rel. Test L2 Loss :  0.015542134605348111  Test L2 Loss :  0.00010535446257563308
Epoch :  350  Rel. Train L2 Loss :  0.009960066683590412  Rel. Test L2 Loss :  0.015246459245681764  Test L2 Loss :  0.00010329089942388236
Epoch :  360  Rel. Train L2 Loss :  0.009643885299563408  Rel. Test L2 Loss :  0.01511643148958683  Test L2 Loss :  0.00010233199165668338
Epoch :  370  Rel. Train L2 Loss :  0.009746047120541335  Rel. Test L2 Loss :  0.015271184109151363  Test L2 Loss :  0.00010332185949664563
Epoch :  380  Rel. Train L2 Loss :  0.00922050927579403  Rel. Test L2 Loss :  0.014939062483608722  Test L2 Loss :  0.00010116988356458023
Epoch :  390  Rel. Train L2 Loss :  0.00902155875042081  Rel. Test L2 Loss :  0.014809996001422404  Test L2 Loss :  0.0001002082452760078
Epoch :  400  Rel. Train L2 Loss :  0.00877056523039937  Rel. Test L2 Loss :  0.014942076951265336  Test L2 Loss :  0.00010096846934175119
Epoch :  410  Rel. Train L2 Loss :  0.00863162137940526  Rel. Test L2 Loss :  0.014722819812595845  Test L2 Loss :  9.949656465323642e-05
Epoch :  420  Rel. Train L2 Loss :  0.008521245550364256  Rel. Test L2 Loss :  0.014567510709166526  Test L2 Loss :  9.885291830869392e-05
Epoch :  430  Rel. Train L2 Loss :  0.008373584222048522  Rel. Test L2 Loss :  0.014420480988919735  Test L2 Loss :  9.769472817424684e-05
Epoch :  440  Rel. Train L2 Loss :  0.008192641858011484  Rel. Test L2 Loss :  0.014508436024188996  Test L2 Loss :  9.815455472562462e-05
Epoch :  450  Rel. Train L2 Loss :  0.008169944133609533  Rel. Test L2 Loss :  0.014491658620536328  Test L2 Loss :  9.811885101953521e-05
Epoch :  460  Rel. Train L2 Loss :  0.008088541984558105  Rel. Test L2 Loss :  0.01431442204862833  Test L2 Loss :  9.704107156721875e-05
Epoch :  470  Rel. Train L2 Loss :  0.007997515000402928  Rel. Test L2 Loss :  0.014360954724252225  Test L2 Loss :  9.718875080579891e-05
Epoch :  480  Rel. Train L2 Loss :  0.007873824495822192  Rel. Test L2 Loss :  0.014343638457357883  Test L2 Loss :  9.709976904559881e-05
Epoch :  490  Rel. Train L2 Loss :  0.007902534462511539  Rel. Test L2 Loss :  0.01432696994394064  Test L2 Loss :  9.694125357782468e-05
Epoch :  499  Rel. Train L2 Loss :  0.007868042014539242  Rel. Test L2 Loss :  0.01415724102407694  Test L2 Loss :  9.590276924427599e-05

batchnorm
(PyTorch) jiayi@jiayi-ubuntu24:~/Codes/GkNO$ /home/jiayi/anaconda3/envs/PyTorch/bin/python /home/jiayi/Codes/GkNO/eq2d/FFT_2D.py
data_in.shape: (2048, 421, 421)
data_out.shape (2048, 421, 421)
x_train.shape:  torch.Size([1000, 44521, 3])
y_train.shape:  torch.Size([1000, 44521, 1])
Start SVD with data shape:  (1000, 44521)
Start training  layer_type:  ['GalerkinConv_pca', 'GalerkinConv_pca', 'GalerkinConv_pca', 'GalerkinConv_pca']
Epoch :  0  Rel. Train L2 Loss :  0.08004041862487793  Rel. Test L2 Loss :  0.0515703409910202  Test L2 Loss :  0.0003485129156615585
^NEpoch :  10  Rel. Train L2 Loss :  0.02599458523094654  Rel. Test L2 Loss :  0.03253323160111904  Test L2 Loss :  0.0002198655530810356
Epoch :  20  Rel. Train L2 Loss :  0.02170232954621315  Rel. Test L2 Loss :  0.0237656806409359  Test L2 Loss :  0.00016132318298332394
Epoch :  30  Rel. Train L2 Loss :  0.020162865586578847  Rel. Test L2 Loss :  0.0236592335999012  Test L2 Loss :  0.00015971034823451192
Epoch :  40  Rel. Train L2 Loss :  0.019609861329197883  Rel. Test L2 Loss :  0.02871810771524906  Test L2 Loss :  0.00019637891673482955
Epoch :  50  Rel. Train L2 Loss :  0.02033101622015238  Rel. Test L2 Loss :  0.023050105720758437  Test L2 Loss :  0.00015717190166469663
Epoch :  60  Rel. Train L2 Loss :  0.020583241418004036  Rel. Test L2 Loss :  0.026467187851667403  Test L2 Loss :  0.00017947049345821143
Epoch :  70  Rel. Train L2 Loss :  0.020397636145353316  Rel. Test L2 Loss :  0.02210364639759064  Test L2 Loss :  0.00014973537734476848
Epoch :  80  Rel. Train L2 Loss :  0.019150072865188123  Rel. Test L2 Loss :  0.019928747862577437  Test L2 Loss :  0.0001351293228799477
Epoch :  90  Rel. Train L2 Loss :  0.020691881984472273  Rel. Test L2 Loss :  0.021243032962083817  Test L2 Loss :  0.00014419506362173707
Epoch :  100  Rel. Train L2 Loss :  0.020445025347173212  Rel. Test L2 Loss :  0.02552676036953926  Test L2 Loss :  0.00017183901974931359
Epoch :  110  Rel. Train L2 Loss :  0.018765214890241622  Rel. Test L2 Loss :  0.024910127744078636  Test L2 Loss :  0.00016886575671378522
Epoch :  120  Rel. Train L2 Loss :  0.018397574067115785  Rel. Test L2 Loss :  0.020271091759204864  Test L2 Loss :  0.00013743898191023618
Epoch :  130  Rel. Train L2 Loss :  0.01915159725397825  Rel. Test L2 Loss :  0.02034572046250105  Test L2 Loss :  0.00013814556790748612
Epoch :  140  Rel. Train L2 Loss :  0.01753245958685875  Rel. Test L2 Loss :  0.02065795484930277  Test L2 Loss :  0.0001399283204227686
Epoch :  150  Rel. Train L2 Loss :  0.01615421488881111  Rel. Test L2 Loss :  0.019687850512564182  Test L2 Loss :  0.00013364229613216594
Epoch :  160  Rel. Train L2 Loss :  0.01614319620281458  Rel. Test L2 Loss :  0.017484290339052678  Test L2 Loss :  0.00011810317460913212
Epoch :  170  Rel. Train L2 Loss :  0.015297971285879612  Rel. Test L2 Loss :  0.01823583126068115  Test L2 Loss :  0.0001239583847927861
Epoch :  180  Rel. Train L2 Loss :  0.014743219181895256  Rel. Test L2 Loss :  0.018406336829066276  Test L2 Loss :  0.0001245304971234873
Epoch :  190  Rel. Train L2 Loss :  0.014803005091845988  Rel. Test L2 Loss :  0.021628565564751626  Test L2 Loss :  0.00014590309292543678
Epoch :  200  Rel. Train L2 Loss :  0.013516643486917019  Rel. Test L2 Loss :  0.016718918308615684  Test L2 Loss :  0.00011337679956341162
Epoch :  210  Rel. Train L2 Loss :  0.014206348523497581  Rel. Test L2 Loss :  0.01673917457461357  Test L2 Loss :  0.00011293859279248863
Epoch :  220  Rel. Train L2 Loss :  0.013353521764278412  Rel. Test L2 Loss :  0.015727242343127727  Test L2 Loss :  0.00010669206705642863
Epoch :  230  Rel. Train L2 Loss :  0.011980771601200103  Rel. Test L2 Loss :  0.016867314577102662  Test L2 Loss :  0.0001153241886640899
Epoch :  240  Rel. Train L2 Loss :  0.012434418097138404  Rel. Test L2 Loss :  0.01522713903337717  Test L2 Loss :  0.00010313959763152524
Epoch :  250  Rel. Train L2 Loss :  0.011625563144683838  Rel. Test L2 Loss :  0.01523951381444931  Test L2 Loss :  0.0001035575577407144
Epoch :  260  Rel. Train L2 Loss :  0.01160356517136097  Rel. Test L2 Loss :  0.015640644766390325  Test L2 Loss :  0.0001058133551850915
Epoch :  270  Rel. Train L2 Loss :  0.01095355662703514  Rel. Test L2 Loss :  0.015249278657138347  Test L2 Loss :  0.00010333837824873627
Epoch :  280  Rel. Train L2 Loss :  0.010644548565149308  Rel. Test L2 Loss :  0.017419663444161414  Test L2 Loss :  0.00011758018226828426
Epoch :  290  Rel. Train L2 Loss :  0.009715002112090587  Rel. Test L2 Loss :  0.017579652778804303  Test L2 Loss :  0.00012102808366762474
Epoch :  300  Rel. Train L2 Loss :  0.009049844473600388  Rel. Test L2 Loss :  0.014747159667313098  Test L2 Loss :  9.988710575271397e-05
Epoch :  310  Rel. Train L2 Loss :  0.00848039498180151  Rel. Test L2 Loss :  0.01347123097628355  Test L2 Loss :  9.108743921387941e-05
Epoch :  320  Rel. Train L2 Loss :  0.008464448187500239  Rel. Test L2 Loss :  0.014116956628859043  Test L2 Loss :  9.612563793780282e-05
Epoch :  330  Rel. Train L2 Loss :  0.008211080834269524  Rel. Test L2 Loss :  0.01355217795819044  Test L2 Loss :  9.180417488096282e-05
Epoch :  340  Rel. Train L2 Loss :  0.00772797391936183  Rel. Test L2 Loss :  0.013046319782733917  Test L2 Loss :  8.870144229149446e-05
Epoch :  350  Rel. Train L2 Loss :  0.007672636661678552  Rel. Test L2 Loss :  0.012907360792160033  Test L2 Loss :  8.757349743973464e-05
Epoch :  360  Rel. Train L2 Loss :  0.006836578503251076  Rel. Test L2 Loss :  0.01297381516546011  Test L2 Loss :  8.77909766859375e-05
Epoch :  370  Rel. Train L2 Loss :  0.00638141331076622  Rel. Test L2 Loss :  0.012948187664151192  Test L2 Loss :  8.804777287878096e-05
Epoch :  380  Rel. Train L2 Loss :  0.006003291353583336  Rel. Test L2 Loss :  0.01306715875864029  Test L2 Loss :  8.819626556942239e-05
Epoch :  390  Rel. Train L2 Loss :  0.005438254319131374  Rel. Test L2 Loss :  0.012128732614219189  Test L2 Loss :  8.217471273383125e-05
Epoch :  400  Rel. Train L2 Loss :  0.005210943229496479  Rel. Test L2 Loss :  0.0123812460526824  Test L2 Loss :  8.416487486101687e-05
Epoch :  410  Rel. Train L2 Loss :  0.0048552540317177775  Rel. Test L2 Loss :  0.012004814185202122  Test L2 Loss :  8.140221907524393e-05
Epoch :  420  Rel. Train L2 Loss :  0.0045010825973004105  Rel. Test L2 Loss :  0.012055422738194465  Test L2 Loss :  8.170631626853719e-05
Epoch :  430  Rel. Train L2 Loss :  0.004190974056720733  Rel. Test L2 Loss :  0.012179341763257981  Test L2 Loss :  8.273259416455403e-05
Epoch :  440  Rel. Train L2 Loss :  0.0038909334093332293  Rel. Test L2 Loss :  0.012055571377277374  Test L2 Loss :  8.182506062439642e-05
Epoch :  450  Rel. Train L2 Loss :  0.003834842216223478  Rel. Test L2 Loss :  0.011934367902576924  Test L2 Loss :  8.083281689323485e-05
Epoch :  460  Rel. Train L2 Loss :  0.0035115868728607894  Rel. Test L2 Loss :  0.011924412176012993  Test L2 Loss :  8.082990709226578e-05
Epoch :  470  Rel. Train L2 Loss :  0.003399184798821807  Rel. Test L2 Loss :  0.011868861168622971  Test L2 Loss :  8.045107882935554e-05
Epoch :  480  Rel. Train L2 Loss :  0.003272350089624524  Rel. Test L2 Loss :  0.011839078441262245  Test L2 Loss :  8.02109538926743e-05
Epoch :  490  Rel. Train L2 Loss :  0.0032709569577127695  Rel. Test L2 Loss :  0.011846164911985398  Test L2 Loss :  8.030241966480389e-05
Epoch :  499  Rel. Train L2 Loss :  0.0031119008511304854  Rel. Test L2 Loss :  0.01184211254119873  Test L2 Loss :  8.027376810787245e-05


(PyTorch) jiayi@jiayi-ubuntu24:~/Codes/GkNO$ /home/jiayi/anaconda3/envs/PyTorch/bin/python /home/jiayi/Codes/GkNO/eq2d/FFT_2D.py
data_in.shape: (2048, 421, 421)
data_out.shape (2048, 421, 421)
x_train.shape:  torch.Size([1000, 44521, 3])
y_train.shape:  torch.Size([1000, 44521, 1])
Start SVD with data shape:  (1000, 44521)
Start training  layer_type:  ['GalerkinConv_pca', 'GalerkinConv_pca', 'GalerkinConv_pca', 'GalerkinConv_pca']
Epoch :  0  Rel. Train L2 Loss :  0.18020961266756058  Rel. Test L2 Loss :  0.13384607970714568  Test L2 Loss :  0.0009292059554718435
Epoch :  10  Rel. Train L2 Loss :  0.05089322608709335  Rel. Test L2 Loss :  0.049718100279569626  Test L2 Loss :  0.00033595262910239397
Epoch :  20  Rel. Train L2 Loss :  0.04317167758941651  Rel. Test L2 Loss :  0.04302692636847496  Test L2 Loss :  0.0002935188077390194
Epoch :  30  Rel. Train L2 Loss :  0.0400367986112833  Rel. Test L2 Loss :  0.04417979806661606  Test L2 Loss :  0.0003013927454594523
Epoch :  40  Rel. Train L2 Loss :  0.03792232665419579  Rel. Test L2 Loss :  0.03968867734074592  Test L2 Loss :  0.0002677543734898791
Epoch :  50  Rel. Train L2 Loss :  0.03738575273752213  Rel. Test L2 Loss :  0.03846858844161034  Test L2 Loss :  0.00026202765526250004
Epoch :  60  Rel. Train L2 Loss :  0.03438940989971161  Rel. Test L2 Loss :  0.035257986187934874  Test L2 Loss :  0.00023871561919804662
Epoch :  70  Rel. Train L2 Loss :  0.034966977655887604  Rel. Test L2 Loss :  0.03702786803245545  Test L2 Loss :  0.0002497805072925985
Epoch :  80  Rel. Train L2 Loss :  0.03381929974257946  Rel. Test L2 Loss :  0.03473474100232124  Test L2 Loss :  0.00023707053856924175
Epoch :  90  Rel. Train L2 Loss :  0.03202370998263359  Rel. Test L2 Loss :  0.03640002243220806  Test L2 Loss :  0.0002457175008021295
Epoch :  100  Rel. Train L2 Loss :  0.030369702965021134  Rel. Test L2 Loss :  0.03231768563389778  Test L2 Loss :  0.00022026146354619413
Epoch :  110  Rel. Train L2 Loss :  0.02913968926668167  Rel. Test L2 Loss :  0.03118486426770687  Test L2 Loss :  0.00021157704235520215
Epoch :  120  Rel. Train L2 Loss :  0.02810870389640331  Rel. Test L2 Loss :  0.03624816693365574  Test L2 Loss :  0.00024812821997329595
Epoch :  130  Rel. Train L2 Loss :  0.028248954311013222  Rel. Test L2 Loss :  0.03298604413866997  Test L2 Loss :  0.00022325043100863696
Epoch :  140  Rel. Train L2 Loss :  0.027935362055897712  Rel. Test L2 Loss :  0.03144717149436474  Test L2 Loss :  0.00021222411771304906
Epoch :  150  Rel. Train L2 Loss :  0.027322587311267854  Rel. Test L2 Loss :  0.027791932448744772  Test L2 Loss :  0.0001891852536937222
Epoch :  160  Rel. Train L2 Loss :  0.025857327073812483  Rel. Test L2 Loss :  0.028658536449074744  Test L2 Loss :  0.000194362499169074
Epoch :  170  Rel. Train L2 Loss :  0.026300956338644026  Rel. Test L2 Loss :  0.028657749220728876  Test L2 Loss :  0.00019355649419594556
Epoch :  180  Rel. Train L2 Loss :  0.024970267713069916  Rel. Test L2 Loss :  0.02711141459643841  Test L2 Loss :  0.0001829691999591887
Epoch :  190  Rel. Train L2 Loss :  0.023791458502411843  Rel. Test L2 Loss :  0.027978566139936448  Test L2 Loss :  0.00018963069072924554
Epoch :  200  Rel. Train L2 Loss :  0.02451780301332474  Rel. Test L2 Loss :  0.030970271751284598  Test L2 Loss :  0.00021075112104881555
Epoch :  210  Rel. Train L2 Loss :  0.023578126057982443  Rel. Test L2 Loss :  0.026421230286359787  Test L2 Loss :  0.00018039866990875452
Epoch :  220  Rel. Train L2 Loss :  0.02300049565732479  Rel. Test L2 Loss :  0.025014932826161386  Test L2 Loss :  0.00016952827281784265
Epoch :  230  Rel. Train L2 Loss :  0.02271829015016556  Rel. Test L2 Loss :  0.023650441020727157  Test L2 Loss :  0.000160760116414167
Epoch :  240  Rel. Train L2 Loss :  0.022309860333800315  Rel. Test L2 Loss :  0.023965845704078673  Test L2 Loss :  0.0001624023774638772
Epoch :  250  Rel. Train L2 Loss :  0.021458113372325897  Rel. Test L2 Loss :  0.023326015174388884  Test L2 Loss :  0.00015835385362152012
Epoch :  260  Rel. Train L2 Loss :  0.020615690782666205  Rel. Test L2 Loss :  0.02332322798669338  Test L2 Loss :  0.00015811495308298617
Epoch :  270  Rel. Train L2 Loss :  0.020539547607302665  Rel. Test L2 Loss :  0.022043399065732956  Test L2 Loss :  0.00014920580695616082
Epoch :  280  Rel. Train L2 Loss :  0.0201813802421093  Rel. Test L2 Loss :  0.022501497268676757  Test L2 Loss :  0.00015254566154908388
Epoch :  290  Rel. Train L2 Loss :  0.01975695017725229  Rel. Test L2 Loss :  0.0230581184476614  Test L2 Loss :  0.0001571938523557037
Epoch :  300  Rel. Train L2 Loss :  0.019063986569643022  Rel. Test L2 Loss :  0.02221501775085926  Test L2 Loss :  0.0001505400420865044
Epoch :  310  Rel. Train L2 Loss :  0.01838782223314047  Rel. Test L2 Loss :  0.021818580105900764  Test L2 Loss :  0.00014710132440086453
Epoch :  320  Rel. Train L2 Loss :  0.017832193709909915  Rel. Test L2 Loss :  0.020792687237262727  Test L2 Loss :  0.00014091659453697503
Epoch :  330  Rel. Train L2 Loss :  0.0173782462105155  Rel. Test L2 Loss :  0.020204202830791475  Test L2 Loss :  0.00013785955758066848
Epoch :  340  Rel. Train L2 Loss :  0.01654193836450577  Rel. Test L2 Loss :  0.019470130652189256  Test L2 Loss :  0.0001315274924854748
Epoch :  350  Rel. Train L2 Loss :  0.016403357341885565  Rel. Test L2 Loss :  0.01963420957326889  Test L2 Loss :  0.00013312798779224977
Epoch :  360  Rel. Train L2 Loss :  0.015964288227260114  Rel. Test L2 Loss :  0.01982652850449085  Test L2 Loss :  0.0001337894130847417
Epoch :  370  Rel. Train L2 Loss :  0.01544520416110754  Rel. Test L2 Loss :  0.019024823009967804  Test L2 Loss :  0.00012910675926832481
Epoch :  380  Rel. Train L2 Loss :  0.014970417149364949  Rel. Test L2 Loss :  0.01795590590685606  Test L2 Loss :  0.0001214169865124859
Epoch :  390  Rel. Train L2 Loss :  0.014555512249469757  Rel. Test L2 Loss :  0.01783572807908058  Test L2 Loss :  0.00012112681986764073
Epoch :  400  Rel. Train L2 Loss :  0.013893112070858478  Rel. Test L2 Loss :  0.017984593845903875  Test L2 Loss :  0.0001219688166747801
Epoch :  410  Rel. Train L2 Loss :  0.013672452032566071  Rel. Test L2 Loss :  0.017088386714458465  Test L2 Loss :  0.0001159858494065702
Epoch :  420  Rel. Train L2 Loss :  0.013216720804572105  Rel. Test L2 Loss :  0.017113174088299276  Test L2 Loss :  0.00011622780235484242
Epoch :  430  Rel. Train L2 Loss :  0.0130896625071764  Rel. Test L2 Loss :  0.016773159615695477  Test L2 Loss :  0.00011354268353898078
Epoch :  440  Rel. Train L2 Loss :  0.012752695426344872  Rel. Test L2 Loss :  0.016607313491404055  Test L2 Loss :  0.0001125094565213658
Epoch :  450  Rel. Train L2 Loss :  0.012525020502507686  Rel. Test L2 Loss :  0.016222861185669898  Test L2 Loss :  0.0001096471500932239
Epoch :  460  Rel. Train L2 Loss :  0.012440788187086582  Rel. Test L2 Loss :  0.01627352464944124  Test L2 Loss :  0.00011034996801754459
Epoch :  470  Rel. Train L2 Loss :  0.012337793506681918  Rel. Test L2 Loss :  0.016453476212918757  Test L2 Loss :  0.00011132397630717606
Epoch :  480  Rel. Train L2 Loss :  0.01204835992306471  Rel. Test L2 Loss :  0.016031092666089534  Test L2 Loss :  0.00010837203561095521
Epoch :  490  Rel. Train L2 Loss :  0.012016881443560123  Rel. Test L2 Loss :  0.016223272196948527  Test L2 Loss :  0.00010994436423061415
Epoch :  499  Rel. Train L2 Loss :  0.012137753434479237  Rel. Test L2 Loss :  0.015789210237562655  Test L2 Loss :  0.00010709412046708166










dir now: /home/jiayi/Codes/GkNO/Encoder
data_in.shape: (2048, 421, 421)
data_out.shape (2048, 421, 421)
x_train.shape:  torch.Size([1000, 44521, 3])
y_train.shape:  torch.Size([1000, 44521, 1])
Start SVD with data shape:  (1000, 44521)
Start SVD with data shape:  (1000, 44521)
Start training  layer_type:  ['DoubleAttention', 'GalerkinConv_fourier', 'GalerkinConv_fourier', 'GalerkinConv_fourier']
25315073
Epoch: 0  Train rel: 0.26556293725967406  Test rel: 0.1271716058254242  Test abs: 0.00085610426729545  Test abs boundary: 0.0007064787112176418  Time: 18.950482198000827
Epoch: 10  Train rel: 0.02138568776845932  Test rel: 0.022785912826657297  Test abs: 0.00015403775847516954  Test abs boundary: 0.000245759614626877  Time: 189.84728153700053
Epoch: 20  Train rel: 0.017159277342259884  Test rel: 0.019476350843906403  Test abs: 0.00013254012679681182  Test abs boundary: 0.00011947852530283854  Time: 190.22682438300035
Epoch: 30  Train rel: 0.0158899544775486  Test rel: 0.020227838419377805  Test abs: 0.00013897262950195  Test abs boundary: 0.00012223519705003126  Time: 190.22621127599996
Epoch: 40  Train rel: 0.014853501804172992  Test rel: 0.018547826930880546  Test abs: 0.0001259179910994135  Test abs boundary: 0.00018356470041908324  Time: 190.02882758600026
Epoch: 50  Train rel: 0.018014538109302522  Test rel: 0.02323095977306366  Test abs: 0.00015880452934652567  Test abs boundary: 0.00011732465907698497  Time: 190.02325646499958
Epoch: 60  Train rel: 0.015562046460807324  Test rel: 0.016482260450720786  Test abs: 0.00011213371559279039  Test abs boundary: 9.553146315738559e-05  Time: 190.0158416080012
Epoch: 70  Train rel: 0.015464760310947895  Test rel: 0.018993571922183036  Test abs: 0.00012814193672966212  Test abs boundary: 0.00011618990160059184  Time: 190.0628923380009
Epoch: 80  Train rel: 0.015208444125950337  Test rel: 0.02062877044081688  Test abs: 0.00013959049159893765  Test abs boundary: 0.0001011655235197395  Time: 190.1323901249998
Epoch: 90  Train rel: 0.014526852823793889  Test rel: 0.021370184123516083  Test abs: 0.00014605750591726975  Test abs boundary: 8.80696313106455e-05  Time: 190.08168695200038
Epoch: 100  Train rel: 0.01455097210407257  Test rel: 0.017984508611261843  Test abs: 0.00012163982493802905  Test abs boundary: 0.00015641419566236436  Time: 190.20594771700053
Epoch: 110  Train rel: 0.013742721863090992  Test rel: 0.020557639189064503  Test abs: 0.00014103149122092872  Test abs boundary: 0.00014363733818754555  Time: 190.26032499399844
Epoch: 120  Train rel: 0.012760308146476745  Test rel: 0.016542412377893924  Test abs: 0.00011174366256454959  Test abs boundary: 8.667971123941243e-05  Time: 190.18841661700026
Epoch: 130  Train rel: 0.013169697612524033  Test rel: 0.016551483534276486  Test abs: 0.00011376159585779533  Test abs boundary: 9.846823522821068e-05  Time: 190.1739493699988
Epoch: 140  Train rel: 0.012445796854794026  Test rel: 0.015133721977472306  Test abs: 0.00010300758294761181  Test abs boundary: 0.00011719179077772424  Time: 190.1413734609996
Epoch: 150  Train rel: 0.011598503343760967  Test rel: 0.01423273302614689  Test abs: 9.644544625189155e-05  Test abs boundary: 7.382306561339647e-05  Time: 190.1398692620005
Epoch: 160  Train rel: 0.01133394230157137  Test rel: 0.01319556400179863  Test abs: 8.961558807641268e-05  Test abs boundary: 7.657487527467311e-05  Time: 190.27223700399918
Epoch: 170  Train rel: 0.010856379508972168  Test rel: 0.013334143310785293  Test abs: 9.057655115611851e-05  Test abs boundary: 8.678242564201355e-05  Time: 190.25741853399995
Epoch: 180  Train rel: 0.010945989526808262  Test rel: 0.012643923163414  Test abs: 8.597376378020271e-05  Test abs boundary: 7.26128721726127e-05  Time: 190.22471625599974
Epoch: 190  Train rel: 0.010038120426237583  Test rel: 0.012663216553628445  Test abs: 8.59340574243106e-05  Test abs boundary: 8.99809313705191e-05  Time: 190.20566640700054
Epoch: 200  Train rel: 0.009174378227442503  Test rel: 0.013011163808405399  Test abs: 8.823928073979914e-05  Test abs boundary: 6.440219120122492e-05  Time: 190.1076433490016
Epoch: 210  Train rel: 0.010039057765156031  Test rel: 0.012916290536522865  Test abs: 8.753067610086873e-05  Test abs boundary: 6.86510736704804e-05  Time: 190.12613832399984
Epoch: 220  Train rel: 0.009091006502509116  Test rel: 0.011592124588787556  Test abs: 7.885225044446997e-05  Test abs boundary: 6.3231944659492e-05  Time: 190.1190674820009
Epoch: 230  Train rel: 0.009026031479239464  Test rel: 0.011976029574871063  Test abs: 8.138612727634609e-05  Test abs boundary: 5.569033062784001e-05  Time: 190.0750223849991
Epoch: 240  Train rel: 0.00819115399569273  Test rel: 0.011947854124009609  Test abs: 8.117843899526633e-05  Test abs boundary: 8.866415213560685e-05  Time: 190.063102438
Epoch: 250  Train rel: 0.00788297189027071  Test rel: 0.011674348451197147  Test abs: 7.947739839437418e-05  Test abs boundary: 8.096607809420674e-05  Time: 190.0662377539993
Epoch: 260  Train rel: 0.008092809911817312  Test rel: 0.011463193744421006  Test abs: 7.769611445837654e-05  Test abs boundary: 5.548548200749792e-05  Time: 190.09430722099933
Epoch: 270  Train rel: 0.007770647458732128  Test rel: 0.012237633615732192  Test abs: 8.30050089280121e-05  Test abs boundary: 9.952258347766474e-05  Time: 189.9791488360006
Epoch: 280  Train rel: 0.006923124801367521  Test rel: 0.011364359110593795  Test abs: 7.703354203840718e-05  Test abs boundary: 5.308146210154518e-05  Time: 190.0513418089995
Epoch: 290  Train rel: 0.006832266975194215  Test rel: 0.011076054275035859  Test abs: 7.532006842666306e-05  Test abs boundary: 5.306988678057678e-05  Time: 190.08620705199974
Epoch: 300  Train rel: 0.006486477039754391  Test rel: 0.01059570038691163  Test abs: 7.205874120700173e-05  Test abs boundary: 5.179723710170947e-05  Time: 190.04424373599977
Epoch: 310  Train rel: 0.006084841936826706  Test rel: 0.010500460881739854  Test abs: 7.14231595338788e-05  Test abs boundary: 5.198501443373971e-05  Time: 190.04086343199924
Epoch: 320  Train rel: 0.006206042978912592  Test rel: 0.010387189462780952  Test abs: 7.047943872748875e-05  Test abs boundary: 4.5845428976463156e-05  Time: 190.00901222600078
Epoch: 330  Train rel: 0.005807567317038774  Test rel: 0.01061462078243494  Test abs: 7.183486406574956e-05  Test abs boundary: 6.823879375588149e-05  Time: 190.02872452300107
Epoch: 340  Train rel: 0.005418550912290812  Test rel: 0.010720527842640876  Test abs: 7.285647559911012e-05  Test abs boundary: 4.8660870088497174e-05  Time: 189.9815180350015
Epoch: 350  Train rel: 0.005028827298432589  Test rel: 0.010105600394308568  Test abs: 6.854239749372937e-05  Test abs boundary: 4.3693916377378625e-05  Time: 189.98670295000193
Epoch: 360  Train rel: 0.004825802359730005  Test rel: 0.010050278007984161  Test abs: 6.828768338891678e-05  Test abs boundary: 5.317927556461655e-05  Time: 189.9735368319998
Epoch: 370  Train rel: 0.00465367367491126  Test rel: 0.01002907270565629  Test abs: 6.799613664043136e-05  Test abs boundary: 4.416687312186696e-05  Time: 190.07737847599856
Epoch: 380  Train rel: 0.004422445608302951  Test rel: 0.009797246865928174  Test abs: 6.656130339251832e-05  Test abs boundary: 3.876947666867636e-05  Time: 189.95499176500016
Epoch: 390  Train rel: 0.004127687996253371  Test rel: 0.009705952443182468  Test abs: 6.594124977709725e-05  Test abs boundary: 4.300628061173484e-05  Time: 189.91571603199918
Epoch: 400  Train rel: 0.003931765161454678  Test rel: 0.009675858207046986  Test abs: 6.572597179911099e-05  Test abs boundary: 3.5921853122999894e-05  Time: 189.94518592199893
Epoch: 410  Train rel: 0.003810579227283597  Test rel: 0.009575476534664631  Test abs: 6.502158139483072e-05  Test abs boundary: 4.201739720883779e-05  Time: 190.0028572179981
Epoch: 420  Train rel: 0.003605214277282357  Test rel: 0.009547618497163058  Test abs: 6.48558366810903e-05  Test abs boundary: 3.5594546134234406e-05  Time: 189.9528668999992
Epoch: 430  Train rel: 0.003479527689516544  Test rel: 0.009587484300136567  Test abs: 6.505707104224711e-05  Test abs boundary: 3.910936196916737e-05  Time: 189.9834007569989
Epoch: 440  Train rel: 0.0033465257287025453  Test rel: 0.009566892571747303  Test abs: 6.498299160739407e-05  Test abs boundary: 3.428612093557604e-05  Time: 189.94333301000006
Epoch: 450  Train rel: 0.0032499910034239294  Test rel: 0.009561458360403776  Test abs: 6.487402730272151e-05  Test abs boundary: 3.7226646818453445e-05  Time: 190.09751956699984
Epoch: 460  Train rel: 0.003135739203542471  Test rel: 0.009525404274463654  Test abs: 6.465842103352771e-05  Test abs boundary: 3.388249650015496e-05  Time: 190.09260371100027
Epoch: 470  Train rel: 0.003071828328073025  Test rel: 0.009500425495207309  Test abs: 6.445707607781515e-05  Test abs boundary: 3.655321736005135e-05  Time: 189.96845144899999
Epoch: 480  Train rel: 0.0030278653390705583  Test rel: 0.009490548614412547  Test abs: 6.442179612349719e-05  Test abs boundary: 3.4346256361459384e-05  Time: 190.02597922600035
Epoch: 490  Train rel: 0.0030016966313123703  Test rel: 0.00945269089192152  Test abs: 6.415808689780534e-05  Test abs boundary: 3.3098398489528336e-05  Time: 190.060943692999
Epoch: 499  Train rel: 0.0029918629582971336  Test rel: 0.009464113470166922  Test abs: 6.419753597583622e-05  Test abs boundary: 3.5469913709675895e-05  Time: 171.11829373399814


(PyTorch) jiayi@jiayi-ubuntu24:~/Codes/GkNO$ /home/jiayi/anaconda3/envs/PyTorch/bin/python /home/jiayi/Codes/GkNO/Encoder/script.py
dir now: /home/jiayi/Codes/GkNO/Encoder
data_in.shape: (2048, 421, 421)
data_out.shape (2048, 421, 421)
x_train.shape:  torch.Size([1000, 44521, 3])
y_train.shape:  torch.Size([1000, 44521, 1])
Start SVD with data shape:  (1000, 44521)
Start SVD with data shape:  (1000, 44521)
Start training  layer_type:  ['DoubleAttention', 'GalerkinConv_fourier', 'GalerkinConv_fourier', 'DoubleAttention']
16976001
Epoch: 0  Train rel: 0.2607823813557625  Test rel: 0.1100689110159874  Test abs: 0.0007500620232895016  Test abs boundary: 0.0005456183897331357  Time: 20.85955963000015
Epoch: 10  Train rel: 0.022185003980994225  Test rel: 0.0277056086063385  Test abs: 0.00018698842846788467  Test abs boundary: 0.00022007790044881404  Time: 205.72070515099767
Epoch: 20  Train rel: 0.01929490727931261  Test rel: 0.02781828686594963  Test abs: 0.00019011320546269417  Test abs boundary: 0.0001831543369917199  Time: 205.7689773989987
Epoch: 30  Train rel: 0.018140040948987007  Test rel: 0.022688487768173216  Test abs: 0.00015541427885182202  Test abs boundary: 9.945491357939318e-05  Time: 205.71928877100436
Epoch: 40  Train rel: 0.0176352262198925  Test rel: 0.02093497596681118  Test abs: 0.00014258971263188868  Test abs boundary: 9.824902837863192e-05  Time: 205.9973087420003
Epoch: 50  Train rel: 0.01641950277239084  Test rel: 0.02044745400547981  Test abs: 0.00013861257757525892  Test abs boundary: 0.00014155268436297775  Time: 206.00342930000625
Epoch: 60  Train rel: 0.018077210329473018  Test rel: 0.02007187932729721  Test abs: 0.0001365954740322195  Test abs boundary: 0.0001251272502122447  Time: 206.1038293649981
Epoch: 70  Train rel: 0.018101243734359743  Test rel: 0.01958518385887146  Test abs: 0.00013331377936992794  Test abs boundary: 0.00012492708483478055  Time: 205.98904017500172
Epoch: 80  Train rel: 0.016995698913931847  Test rel: 0.019300281070172787  Test abs: 0.00013164587435312569  Test abs boundary: 9.6527605492156e-05  Time: 205.94633292700019
Epoch: 90  Train rel: 0.016236586406826972  Test rel: 0.020445966571569444  Test abs: 0.00013826503709424287  Test abs boundary: 7.966519682668149e-05  Time: 206.0179208529953
Epoch: 100  Train rel: 0.015362648710608483  Test rel: 0.01903933446854353  Test abs: 0.00012994643795536832  Test abs boundary: 0.00015297560894396157  Time: 206.1135139639955
Epoch: 110  Train rel: 0.014972521968185902  Test rel: 0.02008086033165455  Test abs: 0.00013551868934882805  Test abs boundary: 0.00013665993814356624  Time: 206.11126364400116
Epoch: 120  Train rel: 0.013384640291333199  Test rel: 0.019769509732723237  Test abs: 0.00013432234583888203  Test abs boundary: 7.296575538930484e-05  Time: 206.18692996100435
Epoch: 130  Train rel: 0.013380113027989865  Test rel: 0.016865480244159698  Test abs: 0.00011490244040032849  Test abs boundary: 8.291378122521565e-05  Time: 206.07988975600165
Epoch: 140  Train rel: 0.013752332918345928  Test rel: 0.018242509588599205  Test abs: 0.00012539018382085488  Test abs boundary: 0.00012256265996256842  Time: 206.14860977599892
Epoch: 150  Train rel: 0.011962458193302154  Test rel: 0.016782475262880327  Test abs: 0.00011453710234491155  Test abs boundary: 9.736138687003403e-05  Time: 206.1313791499997
Epoch: 160  Train rel: 0.01267537770420313  Test rel: 0.01700192216783762  Test abs: 0.00011699067748850211  Test abs boundary: 8.116125522064977e-05  Time: 206.09170517000166
Epoch: 170  Train rel: 0.011309746876358986  Test rel: 0.016357881911098958  Test abs: 0.00011101844487711788  Test abs boundary: 8.278159511974082e-05  Time: 206.14963721300592
Epoch: 180  Train rel: 0.01195954243093729  Test rel: 0.016754273660480976  Test abs: 0.00011396966991014779  Test abs boundary: 7.019170821877196e-05  Time: 206.21032833400386
Epoch: 190  Train rel: 0.010533742345869542  Test rel: 0.016010523363947867  Test abs: 0.00010950046795187518  Test abs boundary: 8.355953381396831e-05  Time: 206.27617426499637
Epoch: 200  Train rel: 0.010135790511965751  Test rel: 0.01594711098819971  Test abs: 0.00010902827809331938  Test abs boundary: 7.084844997734763e-05  Time: 206.03230271199573
Epoch: 210  Train rel: 0.01042036436498165  Test rel: 0.015262221917510033  Test abs: 0.00010396493773441762  Test abs boundary: 7.370272229309193e-05  Time: 206.10650652399636
Epoch: 220  Train rel: 0.01021881965175271  Test rel: 0.01744660910218954  Test abs: 0.00011964786041062326  Test abs boundary: 0.00010321593115804717  Time: 206.13574999100092
Epoch: 230  Train rel: 0.009625184040516615  Test rel: 0.015052327401936055  Test abs: 0.0001024592699832283  Test abs boundary: 5.142560868989676e-05  Time: 206.13991343900125
Epoch: 240  Train rel: 0.008877178505063057  Test rel: 0.014831203110516071  Test abs: 0.00010129634174518287  Test abs boundary: 5.472131262649782e-05  Time: 206.19176467200305
Epoch: 250  Train rel: 0.009061859112232923  Test rel: 0.014567772448062897  Test abs: 9.873742936179043e-05  Test abs boundary: 5.343862663721666e-05  Time: 206.1658493119976
Epoch: 260  Train rel: 0.008586673390120267  Test rel: 0.014384964741766452  Test abs: 9.833373653236776e-05  Test abs boundary: 6.0336578899296e-05  Time: 206.08289360200433
Epoch: 270  Train rel: 0.008257169622927904  Test rel: 0.013794392719864846  Test abs: 9.437835600692779e-05  Test abs boundary: 7.740852335700765e-05  Time: 206.12960547799594
Epoch: 280  Train rel: 0.007777333464473486  Test rel: 0.013635303862392902  Test abs: 9.301902609877288e-05  Test abs boundary: 5.675164706190117e-05  Time: 206.1606286959941
Epoch: 290  Train rel: 0.007592865090817213  Test rel: 0.013490874096751213  Test abs: 9.21646464848891e-05  Test abs boundary: 4.8150116490432993e-05  Time: 206.09248030599701
Epoch: 300  Train rel: 0.007008120320737362  Test rel: 0.013417360223829746  Test abs: 9.151964855846018e-05  Test abs boundary: 4.933109012199566e-05  Time: 206.20351273700362
Epoch: 310  Train rel: 0.00733218003064394  Test rel: 0.01544704608619213  Test abs: 0.00010529795457841828  Test abs boundary: 5.243581545073539e-05  Time: 206.07667236199632
Epoch: 320  Train rel: 0.006920764461159706  Test rel: 0.013164028190076352  Test abs: 8.987704437458888e-05  Test abs boundary: 5.6869697873480616e-05  Time: 206.01603116600018
Epoch: 330  Train rel: 0.006140541359782219  Test rel: 0.01322030071169138  Test abs: 9.019844583235681e-05  Test abs boundary: 4.2514904343988746e-05  Time: 206.19591953400231
Epoch: 340  Train rel: 0.0059502323940396305  Test rel: 0.013003517389297486  Test abs: 8.863976050633937e-05  Test abs boundary: 4.206981699098833e-05  Time: 206.13177756300138
Epoch: 350  Train rel: 0.00553088727965951  Test rel: 0.012822234779596329  Test abs: 8.749131695367395e-05  Test abs boundary: 4.505110176978633e-05  Time: 206.2547143910051
Epoch: 360  Train rel: 0.0053775014318525795  Test rel: 0.012775744162499904  Test abs: 8.705321757588535e-05  Test abs boundary: 4.6044360497035084e-05  Time: 206.13573443300265
Epoch: 370  Train rel: 0.0052888870909810065  Test rel: 0.012788253724575043  Test abs: 8.724208280909807e-05  Test abs boundary: 4.6588537807110696e-05  Time: 206.22580057400046
Epoch: 380  Train rel: 0.0047398158870637416  Test rel: 0.01286448273807764  Test abs: 8.778468749369495e-05  Test abs boundary: 4.477565584238619e-05  Time: 206.20430864900118
Epoch: 390  Train rel: 0.004415233343839645  Test rel: 0.01256811860948801  Test abs: 8.57417390216142e-05  Test abs boundary: 4.201544841635041e-05  Time: 206.10045097900002
Epoch: 400  Train rel: 0.004134852660819888  Test rel: 0.012587075307965278  Test abs: 8.584250375861303e-05  Test abs boundary: 4.085313470568508e-05  Time: 206.13483884999732
Epoch: 410  Train rel: 0.003976826721802354  Test rel: 0.012447759471833707  Test abs: 8.489608531817793e-05  Test abs boundary: 4.27511491579935e-05  Time: 206.0899259430007
Epoch: 420  Train rel: 0.003742414377629757  Test rel: 0.012491357997059822  Test abs: 8.515495457686484e-05  Test abs boundary: 4.161662262049503e-05  Time: 206.09326292300102
Epoch: 430  Train rel: 0.003626851124688983  Test rel: 0.012535790391266345  Test abs: 8.541633069398813e-05  Test abs boundary: 4.433948066434823e-05  Time: 206.2219841029946
Epoch: 440  Train rel: 0.0034235847648233174  Test rel: 0.012467002458870412  Test abs: 8.49390952498652e-05  Test abs boundary: 3.9808573492337016e-05  Time: 206.20614669300267
Epoch: 450  Train rel: 0.003351317897439003  Test rel: 0.012458980605006218  Test abs: 8.49023211048916e-05  Test abs boundary: 3.918531845556572e-05  Time: 206.35163233299681
Epoch: 460  Train rel: 0.0032116168942302467  Test rel: 0.012433048896491527  Test abs: 8.472044224618003e-05  Test abs boundary: 4.0829561912687494e-05  Time: 206.239392194002
Epoch: 470  Train rel: 0.003143947146832943  Test rel: 0.012417992763221263  Test abs: 8.454080758383497e-05  Test abs boundary: 4.070550654432736e-05  Time: 206.2743762359969
Epoch: 480  Train rel: 0.0030816843938082455  Test rel: 0.01241008460521698  Test abs: 8.455854404019192e-05  Test abs boundary: 3.957093715143856e-05  Time: 206.24115670000174
Epoch: 490  Train rel: 0.0030436395276337864  Test rel: 0.012379274889826774  Test abs: 8.434305404080078e-05  Test abs boundary: 3.913998531061225e-05  Time: 206.19012094400387
Epoch: 499  Train rel: 0.003037717990577221  Test rel: 0.012422848790884018  Test abs: 8.458170646918007e-05  Test abs boundary: 3.977709813625552e-05  Time: 185.69553958100005
